function t(t,e,i,n,o){var r=e.getContext("2d");if(r)for(var a=e.width,d=0,l=0,s=0;s<t.length;s++)(d+=r.measureText(t[s]).width)>a-i&&(r.fillText(t.substring(l,s),i,n),n+=o,d=0,l=s),s===t.length-1&&r.fillText(t.substring(l,s+1),i,n)}var e=function(i){var n=i.container,o=void 0===n?"body":n,r=i.width,a=void 0===r?"400px":r,d=i.height,l=void 0===d?"300px":d,s=i.content,c=void 0===s?"mymark":s,v=i.textAlign,u=void 0===v?"center":v,f=i.textBaseline,g=void 0===f?"middle":f,h=i.font,b=void 0===h?"18px Microsoft Yahei":h,p=i.fillStyle,x=void 0===p?"rgba(184, 184, 184, 0.3)":p,m=i.lineHeight,y=void 0===m?25:m,w=i.rotate,S=void 0===w?20:w,A=i.zIndex,O=void 0===A?1024:A,_=i.observe,M=void 0===_||_,k=i.open;if(void 0===k||k){var q="string"==typeof o?document.querySelector(o):o;if(q){var B=document.createElement("canvas");B.setAttribute("width",a),B.setAttribute("height",l);var C=B.getContext("2d");if(C){C.textAlign=u,C.textBaseline=g,C.font=b,C.fillStyle=x,C.rotate(Math.PI/180*S);var E,L,T=parseFloat(a)/2,z=parseFloat(l)/2;"Array"===(E=c,(L=Object.prototype.toString.call(E)).slice(L.indexOf(" ")+1,L.length-1))?c.forEach((function(e,i){t(e,B,T,z+y*i,y)})):t(c,B,T,z,y);var F=B.toDataURL(),I=document.querySelector(".__wm"),J=I||document.createElement("div"),N="\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%; \n    z-index: ".concat(O,";\n    pointer-events: none;\n    background-repeat: repeat;\n    background-image: url('").concat(F,"')");J.setAttribute("style",N),J.classList.add("__wm"),I||(q.style.position="relative",q.insertBefore(J,q.firstChild));var j=window.MutationObserver||window.WebKitMutationObserver;if(M&&j){var D=new j((function(){var t=document.querySelector(".__wm");(t&&t.getAttribute("style")!==N||!t)&&(D.disconnect(),e(JSON.parse(JSON.stringify(i))))}));D.observe(q,{attributes:!0,subtree:!0,childList:!0})}}}}};export{t as fillTextAutoLine,e as watermark};
