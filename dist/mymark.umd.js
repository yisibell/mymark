!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).MyMark={})}(this,(function(t){"use strict";function e(t,e,i,n,o){var r=e.getContext("2d");if(r)for(var a=e.width,d=0,l=0,s=0;s<t.length;s++)(d+=r.measureText(t[s]).width)>a-i&&(r.fillText(t.substring(l,s),i,n),n+=o,d=0,l=s),s===t.length-1&&r.fillText(t.substring(l,s+1),i,n)}var i=function(t){var n=t.container,o=void 0===n?"body":n,r=t.width,a=void 0===r?"400px":r,d=t.height,l=void 0===d?"300px":d,s=t.content,c=void 0===s?"mymark":s,f=t.textAlign,u=void 0===f?"center":f,v=t.textBaseline,g=void 0===v?"middle":v,h=t.font,p=void 0===h?"18px Microsoft Yahei":h,b=t.fillStyle,x=void 0===b?"rgba(184, 184, 184, 0.3)":b,y=t.lineHeight,m=void 0===y?25:y,w=t.rotate,A=void 0===w?20:w,S=t.zIndex,M=void 0===S?1024:S,O=t.observe,T=void 0===O||O,_=t.open;if(void 0===_||_){var k="string"==typeof o?document.querySelector(o):o;if(k){var L=document.createElement("canvas");L.setAttribute("width",a),L.setAttribute("height",l);var q=L.getContext("2d");if(q){q.textAlign=u,q.textBaseline=g,q.font=p,q.fillStyle=x,q.rotate(Math.PI/180*A);var B,C,E=parseFloat(a)/2,j=parseFloat(l)/2;"Array"===(B=c,(C=Object.prototype.toString.call(B)).slice(C.indexOf(" ")+1,C.length-1))?c.forEach((function(t,i){e(t,L,E,j+m*i,m)})):e(c,L,E,j,m);var z=L.toDataURL(),F=document.querySelector(".__wm"),I=F||document.createElement("div"),J="\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%; \n    z-index: ".concat(M,";\n    pointer-events: none;\n    background-repeat: repeat;\n    background-image: url('").concat(z,"')");I.setAttribute("style",J),I.classList.add("__wm"),F||(k.style.position="relative",k.insertBefore(I,k.firstChild));var N=window.MutationObserver||window.WebKitMutationObserver;if(T&&N){var D=new N((function(){var e=document.querySelector(".__wm");(e&&e.getAttribute("style")!==J||!e)&&(D.disconnect(),i(JSON.parse(JSON.stringify(t))))}));D.observe(k,{attributes:!0,subtree:!0,childList:!0})}}}}};t.fillTextAutoLine=e,t.watermark=i}));
