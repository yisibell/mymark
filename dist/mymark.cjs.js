"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function t(t,e,i,o,n){var r=e.getContext("2d");if(r)for(var a=e.width,s=0,d=0,l=0;l<t.length;l++)(s+=r.measureText(t[l]).width)>a-i&&(r.fillText(t.substring(d,l),i,o),o+=n,s=0,d=l),l===t.length-1&&r.fillText(t.substring(d,l+1),i,o)}var e=function(i){var o=i.container,n=void 0===o?"body":o,r=i.width,a=void 0===r?"400px":r,s=i.height,d=void 0===s?"300px":s,l=i.content,c=void 0===l?"mymark":l,v=i.textAlign,u=void 0===v?"center":v,f=i.textBaseline,g=void 0===f?"middle":f,b=i.font,h=void 0===b?"18px Microsoft Yahei":b,p=i.fillStyle,x=void 0===p?"rgba(184, 184, 184, 0.3)":p,m=i.lineHeight,y=void 0===m?25:m,w=i.rotate,A=void 0===w?20:w,S=i.zIndex,_=void 0===S?1024:S,O=i.observe,M=void 0===O||O,k=i.open;if(void 0===k||k){var L="string"==typeof n?document.querySelector(n):n;if(L){var T=document.createElement("canvas");T.setAttribute("width",a),T.setAttribute("height",d);var q=T.getContext("2d");if(q){q.textAlign=u,q.textBaseline=g,q.font=h,q.fillStyle=x,q.rotate(Math.PI/180*A);var B,C,E=parseFloat(a)/2,j=parseFloat(d)/2;"Array"===(B=c,(C=Object.prototype.toString.call(B)).slice(C.indexOf(" ")+1,C.length-1))?c.forEach((function(e,i){t(e,T,E,j+y*i,y)})):t(c,T,E,j,y);var z=T.toDataURL(),F=document.querySelector(".__wm"),I=F||document.createElement("div"),J="\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%; \n    z-index: ".concat(_,";\n    pointer-events: none;\n    background-repeat: repeat;\n    background-image: url('").concat(z,"')");I.setAttribute("style",J),I.classList.add("__wm"),F||(L.style.position="relative",L.insertBefore(I,L.firstChild));var N=window.MutationObserver||window.WebKitMutationObserver;if(M&&N){var P=new N((function(){var t=document.querySelector(".__wm");(t&&t.getAttribute("style")!==J||!t)&&(P.disconnect(),e(JSON.parse(JSON.stringify(i))))}));P.observe(L,{attributes:!0,subtree:!0,childList:!0})}}}}};exports.fillTextAutoLine=t,exports.watermark=e;
